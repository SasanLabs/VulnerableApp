package org.sasanlabs.service.vulnerability.sampleVulnerability;

import org.sasanlabs.internal.utility.LevelConstants;
import org.sasanlabs.internal.utility.Variant;
import org.sasanlabs.internal.utility.annotations.AttackVector;
import org.sasanlabs.internal.utility.annotations.VulnerableAppRequestMapping;
import org.sasanlabs.internal.utility.annotations.VulnerableAppRestController;
import org.sasanlabs.service.vulnerability.bean.GenericVulnerabilityResponseBean;
import org.sasanlabs.vulnerability.types.VulnerabilityType;
import org.springframework.web.bind.annotation.RequestParam;

@VulnerableAppRestController(
        descriptionLabel = "SAMPLE_VULNERABILITY",
        value = "SampleVulnerability")
public class SampleVulnerability {

    @AttackVector(
            vulnerabilityExposed = VulnerabilityType.SAMPLE_VULNERABILITY,
            description = "SAMPLE_VULNERABILITY_USER_INPUT_HANDLING_INJECTION",
            payload = "NOT_APPLICABLE")
    @VulnerableAppRequestMapping(
            value = LevelConstants.LEVEL_1,
            htmlTemplate = "LEVEL_1/SampleVulnerability")
    public GenericVulnerabilityResponseBean<String> sampleUnsecuredLevel(
            @RequestParam("name") String key) {
        return new GenericVulnerabilityResponseBean<>("Not Implemented", true);
    }

    @VulnerableAppRequestMapping(
            value = LevelConstants.LEVEL_2,
            htmlTemplate = "LEVEL_1/SampleVulnerability",
            variant = Variant.SECURE)
    public GenericVulnerabilityResponseBean<String> sampleSecuredLevel(
            @RequestParam("name") String key) {
        return new GenericVulnerabilityResponseBean<>("Not Implemented", true);
    }
}
